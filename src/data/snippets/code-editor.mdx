---
title: 'Code Editor'
summary: 'Live code editor using React-Live, with syntax highlighting and a preview pane to render your React code.'
canonical: 'https://misha.wtf/snippets/code-editor'
tags: ['React', 'Code Editor', 'React-Live']
---

### Code

#### Usage

```jsx:index.js
import CodeBlock from './CodeBlock';

const code = `
() => {
  return (
    <button type="button">Click Me</button>
  );
};
`;

export default function CodeEditor() {
  return <CodeBlock code={code} />;
}
```

#### Implementation

```jsx:CodeBlock.js
import React from 'react';
import { SiPrettier } from 'react-icons/si';
import { LiveEditor, LiveError, LivePreview, LiveProvider } from 'react-live';
import cn from 'classnames/dedupe';
import { useTheme } from 'next-themes';
import babelParser from 'prettier/parser-babel';
import prettier from 'prettier/standalone';
import darkTheme from 'prism-react-renderer/themes/vsDark';
import lightTheme from 'prism-react-renderer/themes/vsLight';

import Button from './Button';
import CopyButton from './CopyButton';

const scope = {
  Button,
  CopyButton,
  ...React,
};

const CodeBlock = ({ children: rootChildren, noInline = false }) => {
  const [isMounted, setIsMounted] = React.useState(false);
  const { children } = rootChildren.props;
  const code = children.trim();
  const [editorCode, setEditorCode] = React.useState(code.trim());
  const { theme } = useTheme();
  let syntaxTheme = darkTheme;

  if (theme === 'light') {
    syntaxTheme = lightTheme;
  }

  const formatOnKey = (e) => {
    if (e.ctrlKey && e.keyCode === 76) {
      formatCode();
    }
  };

  const formatCode = () => {
    setEditorCode((currentCode) =>
      prettier
        .format(currentCode, {
          parser: 'babel',
          plugins: [babelParser],
          trailingComma: 'es5',
        })
        .slice(0, -1)
    );
  };

  const onChange = (newCode) => setEditorCode(newCode.trim());

  React.useEffect(() => {
    setIsMounted(true);
    document.addEventListener('keyup', formatOnKey, false);
    return () => document.removeEventListener('keyup', formatOnKey, false);
  }, []);

  if (isMounted && code) {
    return (
      <div className="flex flex-col items-center justify-center w-full">
        <LiveProvider
          code={editorCode}
          theme={syntaxTheme}
          scope={scope}
          noInline={noInline}
        >
          <LivePreview className="w-full p-2 rounded-md bg-white/50 backdrop-blur-lg dark:bg-gray-900/50" />
          <div
            className={cn(
              'relative mt-4 flex w-full flex-col items-center justify-center rounded-md p-2',
              {
                'bg-[#1E1E1E]': theme === 'dark',
                'bg-[#FFFFFF]': theme === 'light',
              }
            )}
          >
            <div className="absolute flex items-center justify-center gap-2 top-3 right-3">
              <Button aria-label="Format code" title="Format code" onClick={formatCode}>
                <SiPrettier />
              </Button>
              <CopyButton code={code} />
            </div>
            <div className="text-xs font-bold text-gray-400 uppercase">
              Editable Example
            </div>
            <LiveEditor onChange={onChange} className="w-full p-2" />
          </div>
          <LiveError className="w-full p-2 mt-4 text-white bg-red-600" />
        </LiveProvider>
      </div>
    );
  }
  return null;
};

export default CodeBlock;
```

<hr />

### Demo

And here it is in action! Feel free to try things out.

```jsx live
() => {
  const [count, setCount] = useState(0);

  return <Button onClick={() => setCount((count) => count + 1)}>Count: {count}</Button>;
};
```
